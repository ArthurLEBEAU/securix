(()=>{var g={sProcessing:"Traitement en cours ...",sLengthMenu:"Afficher _MENU_ lignes",sZeroRecords:"Aucun r\xE9sultat trouv\xE9",sEmptyTable:"Aucune donn\xE9e disponible",sInfo:"Lignes _START_ \xE0 _END_ sur _TOTAL_",sInfoEmpty:"Aucune ligne affich\xE9e",sInfoFiltered:"(Filtrer un maximum de_MAX_)",sInfoPostFix:"",sSearch:"Chercher:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Chargement...",oPaginate:{sFirst:"Premier",sLast:"Dernier",sNext:"Suivant",sPrevious:"Pr\xE9c\xE9dent"},oAria:{sSortAscending:": Trier par ordre croissant",sSortDescending:": Trier par ordre d\xE9croissant"}};$(document).ready(async function(){let d="http://localhost:3000/api/categorie/",s=$("#categoriesTable").DataTable({ajax:{url:d,cache:!0,dataSrc:"categories"},language:g,data:{},contentType:"application/json",dataType:"json",scrollY:"40vh",paging:!0,pageLength:6,bAutoWidth:!1,responsive:!0,pageResize:!0,lengthChange:!0,columns:[{data:"id"},{data:"name"},{data:"type"},{data:"created_at"},{defaultContent:'<div class="action"><button class="btn btn_update text-white"><i class="fa fa-pencil-alt"></i></button><button class="btn btn_delete text-white"><i class="fa fa-trash-alt"></i></button></div>'}],createdRow:function(n,o,e,t){$(n).attr("data-id",o._id)}}),f=!0,a=!1,h=document.querySelector(".btn_create"),i=document.querySelector(".pop_frame"),S=document.querySelector(".close_btn"),_=document.querySelector(".pop_frame form"),p=document.querySelector(".pop_frame form> h1"),c=document.querySelector(".pop_frame form> button"),l=0;S.addEventListener("click",()=>{document.querySelector(".pop_frame form").reset(),i.classList.toggle("active"),l=0}),h.addEventListener("click",()=>{p.textContent="Nouvelle Categorie",f=!0,i.classList.toggle("active")}),$(document).on("click",".btn_update",n=>{f=!1,p.textContent="Modifier Categorie",c.textContent="modifier",l=$($(n.target).closest("tr")).attr("data-id");let o=s.rows();for(let e=0;e<s.rows()[0].length;e++){let t=s.rows(e).data()[0];t._id==l&&($("#name").val(t.name),$("#type").val(t.type),$("#description").val(t.description))}i.classList.toggle("active")}),$(document).on("click",".btn_delete",n=>{let o=$(n.target).closest("tr"),e=$(o).attr("data-id");Swal.fire({title:"voulez vous vraiment supprimer ?",showCancelButton:!0,confirmButtonText:"Confirmer"}).then(t=>{t.isConfirmed&&$.ajax({url:d+e,method:"delete",data:{id:e},success:function(){s.row(o).remove().draw(),Swal.fire("categorie supprimer!","","success")}})})}),$("#form_modal").submit(function(n){if(n.preventDefault(),a)return;let o=$.trim($("#name").val()),e=$.trim($("#type").val()),t=$.trim($("#description").val());f?$.ajax({url:d,method:"post",contentType:"application/json",data:JSON.stringify({name:o,cat_type:e,description:t}),success:function(r){c.textContent="enregistrer",a=!1,Swal.fire({icon:"success",text:"Categorie ajout\xE9e !",showConfirmButton:!1,timer:1e3}),s.ajax.reload(null,!1),document.querySelector(".pop_frame form").reset(),i.classList.toggle("active")},error:function(r){if(c.textContent="enregistrer",a=!1,r.status==422){let u="";for(let m in r.responseJSON.error)u+=`<li>${r.responseJSON.error[m]}</li>`;Swal.fire({icon:"error",title:"Oops...",html:`<ul>${u}</ul>`})}else Swal.fire({icon:"error",title:"Oops...",text:r.responseJSON.error})}}):$.ajax({url:d+l,method:"patch",contentType:"application/json",data:JSON.stringify({name:o,cat_type:e,description:t}),success:function(r){c.textContent="modifier",a=!1,Swal.fire({icon:"success",text:"Categorie modifier !",showConfirmButton:!1,timer:1e3}),s.ajax.reload(null,!1),document.querySelector(".pop_frame form").reset(),i.classList.toggle("active"),l=0},error:function(r){if(c.textContent="modifier",a=!1,r.status==422){let u="";for(let m in r.responseJSON.error)u+=`<li>${r.responseJSON.error[m]}</li>`;Swal.fire({icon:"error",title:"Oops...",html:`<ul>${u}</ul>`})}else Swal.fire({icon:"error",title:"Oops...",text:"une erreur est survenue!"})}})})});})();
