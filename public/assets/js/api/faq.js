(()=>{var h={sProcessing:"Traitement en cours ...",sLengthMenu:"Afficher _MENU_ lignes",sZeroRecords:"Aucun r\xE9sultat trouv\xE9",sEmptyTable:"Aucune donn\xE9e disponible",sInfo:"Lignes _START_ \xE0 _END_ sur _TOTAL_",sInfoEmpty:"Aucune ligne affich\xE9e",sInfoFiltered:"(Filtrer un maximum de_MAX_)",sInfoPostFix:"",sSearch:"Chercher:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Chargement...",oPaginate:{sFirst:"Premier",sLast:"Dernier",sNext:"Suivant",sPrevious:"Pr\xE9c\xE9dent"},oAria:{sSortAscending:": Trier par ordre croissant",sSortDescending:": Trier par ordre d\xE9croissant"}};$(document).ready(async function(){let f="/api/request/",s=$("#faqTable").DataTable({ajax:{url:f,cache:!0,dataSrc:"faq"},language:h,data:{},contentType:"application/json",dataType:"json",pageLength:6,scrollY:"40vh",paging:!0,bAutoWidth:!1,responsive:!0,pageResize:!0,lengthChange:!0,columns:[{data:"id"},{data:"name"},{data:"question"},{data:"created_at"},{defaultContent:'<div class="action"><button class="btn btn_update text-white"><i class="fa fa-pencil-alt"></i></button><button class="btn btn_delete text-white"><i class="fa fa-trash-alt"></i></button></div>'}],createdRow:function(o,n,t,e){$(o).attr("data-id",n._id)}}),d=!0,a=!1,S=document.querySelector(".btn_create"),i=document.querySelector(".pop_frame"),_=document.querySelector(".close_btn"),x=document.querySelector(".pop_frame form"),p=document.querySelector(".pop_frame form> h1"),l=document.querySelector(".pop_frame form> button"),c=0;_.addEventListener("click",()=>{document.querySelector(".pop_frame form").reset(),i.classList.toggle("active"),c=0}),S.addEventListener("click",()=>{p.textContent="Nouvelle Question",d=!0,i.classList.toggle("active")}),$(document).on("click",".btn_update",o=>{d=!1,p.textContent="Modifier Question",l.textContent="modifier",c=$($(o.target).closest("tr")).attr("data-id");let n=s.rows();for(let t=0;t<s.rows()[0].length;t++){let e=s.rows(t).data()[0];e._id==c&&($("#name").val(e.name),$("#email").val(e.email),$("#question").val(e.question),$("#response").val(e.response))}i.classList.toggle("active")}),$(document).on("click",".btn_delete",o=>{let n=$(o.target).closest("tr"),t=$(n).attr("data-id");Swal.fire({title:"voulez vous vraiment supprimer ?",showCancelButton:!0,confirmButtonText:"Confirmer"}).then(e=>{e.isConfirmed&&$.ajax({url:f+t,method:"delete",data:{id:t},success:function(){s.row(n).remove().draw(),Swal.fire("question supprimer!","","success")}})})}),$("#form_modal").submit(function(o){if(o.preventDefault(),a)return;let n=$.trim($("#name").val()),t=$.trim($("#email").val()),e=$.trim($("#question").val()),g=$.trim($("#response").val());d?$.ajax({url:f,method:"post",contentType:"application/json",data:JSON.stringify({name:n,email:t,question:e,reponse:g}),success:function(r){l.textContent="enregistrer",a=!1,Swal.fire({icon:"success",text:"Question ajout\xE9e !",showConfirmButton:!1,timer:1e3}),s.ajax.reload(null,!1),document.querySelector(".pop_frame form").reset(),i.classList.toggle("active")},error:function(r){if(l.textContent="enregistrer",a=!1,r.status==422){let u="";for(let m in r.responseJSON.error)u+=`<li>${r.responseJSON.error[m]}</li>`;Swal.fire({icon:"error",title:"Oops...",html:`<ul>${u}</ul>`})}else Swal.fire({icon:"error",title:"Oops...",text:r.responseJSON.error})}}):$.ajax({url:f+c,method:"patch",contentType:"application/json",data:JSON.stringify({name:n,email:t,question:e,reponse:g}),success:function(r){l.textContent="modifier",a=!1,Swal.fire({icon:"success",text:"Question modifi\xE9e !",showConfirmButton:!1,timer:1e3}),s.ajax.reload(null,!1),document.querySelector(".pop_frame form").reset(),i.classList.toggle("active"),c=0},error:function(r){if(l.textContent="modifier",a=!1,r.status==422){let u="";for(let m in r.responseJSON.error)u+=`<li>${r.responseJSON.error[m]}</li>`;Swal.fire({icon:"error",title:"Oops...",html:`<ul>${u}</ul>`})}else Swal.fire({icon:"error",title:"Oops...",text:"une erreur est survenue!"})}})})});})();
